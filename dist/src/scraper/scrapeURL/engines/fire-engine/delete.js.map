{"version":3,"file":"delete.js","sourceRoot":"","sources":["../../../../../../src/scraper/scrapeURL/engines/fire-engine/delete.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AACA,qDAAuC;AAEvC,2CAA8C;AAEvC,KAAK,UAAU,gBAAgB,CAAC,MAAc,EAAE,KAAa;IAChE,MAAM,aAAa,GAAG,OAAO,CAAC,GAAG,CAAC,oBAAqB,CAAC;IAExD,MAAM,MAAM,CAAC,SAAS,CAAC;QACnB,IAAI,EAAE,4BAA4B;QAClC,UAAU,EAAE;YACR,KAAK;SACR;KACJ,EAAE,KAAK,EAAC,IAAI,EAAC,EAAE;QACZ,MAAM,IAAA,mBAAW,EACb;YACI,GAAG,EAAE,GAAG,aAAa,WAAW,KAAK,EAAE;YACvC,MAAM,EAAE,QAAQ;YAChB,OAAO,EAAE;gBACL,GAAG,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC,CAAC;oBAC1B,cAAc,EAAE,MAAM,CAAC,iBAAiB,CAAC,IAAI,CAAC;oBAC9C,SAAS,EAAE,MAAM,CAAC,mBAAmB,CAAC,IAAI,CAAC;iBAC9C,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;aACX;YACD,cAAc,EAAE,IAAI;YACpB,aAAa,EAAE,IAAI;YACnB,MAAM,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE,MAAM,EAAE,8BAA8B,EAAE,KAAK,EAAE,CAAC;SAC1E,CACJ,CAAA;IACL,CAAC,CAAC,CAAC;IAEH,4CAA4C;AAChD,CAAC;AA3BD,4CA2BC","sourcesContent":["import { Logger } from \"winston\";\nimport * as Sentry from \"@sentry/node\";\n\nimport { robustFetch } from \"../../lib/fetch\";\n\nexport async function fireEngineDelete(logger: Logger, jobId: string) {\n    const fireEngineURL = process.env.FIRE_ENGINE_BETA_URL!;\n\n    await Sentry.startSpan({\n        name: \"fire-engine: Delete scrape\",\n        attributes: {\n            jobId,\n        }\n    }, async span => {\n        await robustFetch(\n            {\n                url: `${fireEngineURL}/scrape/${jobId}`,\n                method: \"DELETE\",\n                headers: {\n                    ...(Sentry.isInitialized() ? ({\n                        \"sentry-trace\": Sentry.spanToTraceHeader(span),\n                        \"baggage\": Sentry.spanToBaggageHeader(span),\n                    }) : {}),\n                },\n                ignoreResponse: true,\n                ignoreFailure: true,\n                logger: logger.child({ method: \"fireEngineDelete/robustFetch\", jobId }),\n            }\n        )\n    });\n\n    // We do not care whether this fails or not.\n}"]}